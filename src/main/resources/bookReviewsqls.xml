<?xml version="1.0" encoding="utf-8"?>

<sqls name="bookReview">
  
     <sql name="INSERT_BOOKREVIEW_SQL">
        <description>책 리뷰 등록</description>
        <query>
            <![CDATA[
             INSERT INTO BOOKREVIEW(book_id, user_id, recommend, title, review)  
             VALUES (?, ?, ?, ?, ?)
            ]]>
        </query>
     </sql>
    
     <sql name="MODIFY_BOOKREVIEW_SQL">
        <description>책 리뷰 수정하기</description>
        <query>
            <![CDATA[
             UPDATE BOOKREVIEW 
             	SET TITLE = ? 
             	    REVIEW = ?
              WHERE id=?
            ]]>
        </query>
     </sql>
     
     <sql name="DELETE_BOOKREVIEW_SQL">
        <description>책 리뷰 삭제</description>
        <query>
            <![CDATA[
             DELETE FROM BOOKREVIEW 
             WHERE id=? 
               AND book_id=? 
               AND user_id=? 
            ]]>
        </query>
     </sql>
    
    
     <sql name="LIST_BOOKREVIEW_SQL">
        <description>책 리뷰 목록(책조회시)</description>
        <query>
            <![CDATA[
             SELECT U.id as uid
             	    ,U.user_id as user_id 
             	    ,U.name as user_name 
             	    ,U.nickname as user_nickname
             	    ,BR.recommend as recommend
             	    ,BR.title as title 
             	    ,BR.id as id 
             FROM USER U, BOOKREVIEW BR  
             WHERE BR.book_id=? 
               AND BR.user_id=U.id 
               AND U.delete_y_n=0  
             LIMIT ?,? 
            ]]>
        </query>
     </sql>
    
    
     <sql name="LIST_MYBOOKREVIEW_SQL">
        <description>내가 작성한 책 리뷰 목록</description>
        <query>
            <![CDATA[
             SELECT BR.id as id
             		,BR.recommend as recommend 
             		,BR.title as title 
             		,BR.book_id as bid 
             	    ,B.name as bname
             	    ,B.isbn10 as bisbn
             	    ,B.publish_comp as bcomp
             FROM BOOK B, USER U, BOOKREVIEW BR  
             WHERE BR.user_id = ?  
               AND BR.user_id=U.id 
               AND BR.book_id=B.id  
               AND U.delete_y_n=0 
             LIMIT ?,? 
            ]]>
        </query>
    </sql>
    
    
     <sql name="GET_MY_BOOKREVIEW_SQL">
        <description>책 리뷰(내가쓴 리뷰)- 수정화면</description>
        <query>
            <![CDATA[
             SELECT U.id as uid
             	    ,U.user_id as user_id 
             	    ,U.name as user_name 
             	    ,U.nickname as user_nickname
             	    ,BR.id as id 
             	    ,BR.recommend as recommend
             	    ,BR.review as review 
             	    ,BR.title as title 
             FROM USER U, BOOKREVIEW BR  
             WHERE BR.id = ? 
               AND BR.book_id = ? 
               AND BR.user_id = U.id 
               AND U.user_id = ?  
               AND U.delete_y_n = 0  
            ]]>
        </query>
    </sql>
    
     <sql name="GET_BOOKREVIEW_SQL">
        <description>책 리뷰</description>
        <query>
            <![CDATA[
             SELECT U.id as uid
             	    ,U.user_id as user_id 
             	    ,U.name as user_name 
             	    ,U.nickname as user_nickname
             	    ,BR.id as id 
             	    ,BR.recommend as recommend
             	    ,BR.review as review 
             	    ,BR.title as title
             	    ,B.id as bid
             FROM USER U, BOOKREVIEW BR, BOOK B  
             WHERE BR.id = ? 
               AND BR.user_id = U.id 
               AND BR.book_id=B.id  
               AND U.delete_y_n = 0    
            ]]>
        </query>
    </sql>
    
    
     <sql name="EXIST_MYBOOKREVIEW_SQL">
        <description>내가 작성한 책 리뷰가 있는지 체크</description>
        <query>
            <![CDATA[
             SELECT count(BG.id) as count
             FROM BOOKREVIEW BR USER U 
             WHERE BR.book_id = ? 
               AND BR.user_id = ? 
               AND BR.user_id=U.id 
               AND U.delete_y_n=0  
            ]]>
        </query>
    </sql>
    


    
</sqls>